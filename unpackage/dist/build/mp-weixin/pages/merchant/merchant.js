(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/merchant/merchant"],{"350e":function(e,t,n){"use strict";var o={"uni-combox":function(){return n.e("components/uni-combox/uni-combox").then(n.bind(null,"cd15"))}},i=function(){var e=this,t=e.$createElement;e._self._c},s=[];n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o}))},4205:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n("2f62");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=function(){n.e("components/uni-combox/uni-combox").then(function(){return resolve(n("cd15"))}.bind(null,n)).catch(n.oe)},c={components:{uniCombox:a},data:function(){return{isChange:!1,totalH:0,infoList:"",codeUrl:"",uploadPicUrl:"",nameText:"",serviceType:"",servieTypeList:"",merchantType:"",merchantTypeList:"",contactText:"",addressText:"",descriptionText:"",moreImgList:""}},onLoad:function(t){var n=this;e.getSystemInfo({success:function(t){n.totalH=t.windowHeight-e.upx2px(62)}}),1==t.isChange?this.isChange=!0:this.isChange=!1,this.__init()},computed:s({},(0,o.mapState)({}),{},(0,o.mapGetters)([]),{getServiceTypeName:function(){if(""==this.servieTypeList)return"请选择";for(var e=this.servieTypeList,t=0;t<e.length;t++)if(e[t].Value==this.serviceType)return e[t].Text},getServiceTypeNameList:function(){var e=[];if(""!=this.servieTypeList)for(var t=this.servieTypeList,n=0;n<t.length;n++)e.push(t[n].Text);return e},getMerchantTypeName:function(){if(""==this.merchantTypeList)return"请选择";for(var e=this.merchantTypeList,t=0;t<e.length;t++)if(e[t].Value==this.merchantType)return e[t].Text},getMerchantTypeNameList:function(){var e=[];if(""!=this.merchantTypeList)for(var t=this.merchantTypeList,n=0;n<t.length;n++)e.push(t[n].Text);return e}}),methods:s({},(0,o.mapMutations)([]),{},(0,o.mapActions)([]),{__init:function(){var t=this;t.$H.post("/api/merchant/QRCode",{},{token:!0}).then((function(n){console.log(n),0==n.status?(t.codeUrl=n.data,t.getMerchantInfo()):e.showToast({title:n.message,icon:"none",duration:1e3})}))},getMerchantInfo:function(){var t=this;t.$H.post("/api/merchant/Intro",{},{token:!0}).then((function(n){console.log(n),0==n.status?(t.syncMerchantInfo(n.data),t.getServieTypeList(),t.getMerchantTypeList(t.serviceType)):e.showToast({title:n.message,icon:"none",duration:1e3})}))},syncMerchantInfo:function(e){this.infoList=e,this.uploadPicUrl=e.FaceUrl,this.moreImgList=e.ImgList,this.nameText=e.Name,this.serviceType=e.ServiceType,this.merchantType=e.MerchantTypeID,this.descriptionText=e.Description,this.contactText=e.Contact,this.addressText=e.Address},getServieTypeList:function(){var t=this;t.$H.post("/api/merchant/ServieType",{},{token:!0}).then((function(n){console.log(n),0==n.status?t.servieTypeList=n.data:e.showToast({title:n.message,icon:"none",duration:1e3})}))},getMerchantTypeList:function(t){var n=this,o={};t&&(o.ServieType=t),n.$H.post("/api/merchant/MerchantType",o,{token:!0}).then((function(t){console.log(t),0==t.status?n.merchantTypeList=t.data:e.showToast({title:t.message,icon:"none",duration:1e3})}))},nameInput:function(e){this.nameText=e.detail.value},serviceTypeInput:function(e){for(var t=this.servieTypeList,n=0;n<t.length;n++){var o=t[n].Text;if(o==e&&this.serviceType!=t[n].Value)return this.serviceType=t[n].Value,console.log(this.serviceType),this.merchantType=0,void this.getMerchantTypeList(this.serviceType)}},merchantTypeInput:function(e){for(var t=this.merchantTypeList,n=0;n<t.length;n++){var o=t[n].Text;if(o==e)return this.merchantType=t[n].Value,void console.log(this.merchantType)}},contactInput:function(e){this.contactText=e.detail.value},addressInput:function(e){this.addressText=e.detail.value},descriptionInput:function(e){this.descriptionText=e.detail.value},uploadFaceImg:function(){var t=this;e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album"],success:function(e){e.tempFilePaths,t.urlTobase64(e.tempFilePaths[0],t.uploadPic,"face")},error:function(e){console.log(e)}})},uploadMoreImg:function(){var t=this;e.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album"],success:function(e){e.tempFilePaths,t.urlTobase64(e.tempFilePaths[0],t.uploadPic,"more")},error:function(e){console.log(e)}})},uploadPic:function(t,n){var o=this;e.showLoading({title:"上传图片中..."});var i="";"face"==n?i="/api/merchant/UploadFaceImg":"more"==n&&(i="/api/merchant/UploadMoreImg"),o.$H.post(i,{base64:t},{token:!0}).then((function(i){console.log(i),e.hideLoading(),0==i.status?"face"==n?o.uploadPicUrl=t:"more"==n&&o.moreImgList.push(i.data):e.showToast({title:i.message,icon:"none",duration:1e3})}))},urlTobase64:function(t,n,o){e.request({url:t,method:"GET",responseType:"arraybuffer",success:function(e){var t=wx.arrayBufferToBase64(e.data);t="data:image/jpeg;base64,"+t,n(t,o)}})},deleteMoreImg:function(t){var n=this;e.showModal({title:"提示",content:"确定删除图片",success:function(e){e.confirm?n.deleteMoreImgSure(t):e.cancel&&console.log("用户点击取消")}})},deleteMoreImgSure:function(t){var n=this,o=n.moreImgList[t];console.log(o),n.$H.post("/api/merchant/DelImg",{imgPath:o},{token:!0}).then((function(o){console.log(o),e.hideLoading(),0==o.status?n.moreImgList.splice(t,1):e.showToast({title:o.message,icon:"none",duration:1e3})}))},saveChange:function(){var t=this;t.$H.post("/api/merchant/SaveIntro",{ServiceType:t.serviceType,MerchantTypeID:t.merchantType,Name:t.nameText,Contact:t.contactText,Address:t.addressText,Description:t.descriptionText},{token:!0}).then((function(t){console.log(t),e.hideLoading(),0==t.status?e.showToast({title:"保存店铺信息成功",icon:"none",duration:1500}):e.showToast({title:t.message,icon:"none",duration:1e3})}))}})};t.default=c}).call(this,n("543d")["default"])},"7a0f":function(e,t,n){"use strict";(function(e){n("2e69"),n("921b");o(n("66fd"));var t=o(n("cc35"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},afd8:function(e,t,n){"use strict";n.r(t);var o=n("4205"),i=n.n(o);for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t["default"]=i.a},cc35:function(e,t,n){"use strict";n.r(t);var o=n("350e"),i=n("afd8");for(var s in i)"default"!==s&&function(e){n.d(t,e,(function(){return i[e]}))}(s);var r,a=n("f0c5"),c=Object(a["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],r);t["default"]=c.exports}},[["7a0f","common/runtime","common/vendor"]]]);