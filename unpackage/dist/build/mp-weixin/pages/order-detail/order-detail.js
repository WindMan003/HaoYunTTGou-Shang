(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order-detail/order-detail"],{4182:function(t,e,r){"use strict";r.r(e);var n=r("e581"),o=r("fc21");for(var s in o)"default"!==s&&function(t){r.d(e,t,(function(){return o[t]}))}(s);var u,a=r("f0c5"),i=Object(a["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],u);e["default"]=i.exports},5715:function(t,e,r){"use strict";(function(t){r("2e69"),r("921b");n(r("66fd"));var e=n(r("4182"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,r("543d")["createPage"])},a58a:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r("2f62");function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a={components:{},data:function(){return{totalH:0,defaultStatus:["未确认","进行中","支付中","已完成","用户取消","商户取消"],OrderItem:[],ProductList:[],tableNumberText:"",statusList:[],select:!1}},onLoad:function(e){var r=this;t.getSystemInfo({success:function(e){r.totalH=e.windowHeight-t.upx2px(62)}}),e.ID&&this.getItem(e.ID)},computed:s({},(0,n.mapState)({orderList:function(t){return t.order.orderList}}),{},(0,n.mapGetters)([]),{getCancelShow:function(){return 0==this.OrderItem.Status||1==this.OrderItem.Status},getConfirmShow:function(){return 0==this.OrderItem.Status}}),methods:s({},(0,n.mapMutations)([]),{},(0,n.mapActions)(["updateOrderListFunc"]),{getItem:function(t){var e=this;e.$H.post("/api/Order/Detail",{OrderID:t},{token:!0}).then((function(t){console.log(t),0===t.status?(e.OrderItem=t.data.OrderItem,e.tableNumberText=t.data.OrderItem.TableNumber,e.tidyProductList(t.data.ProductList)):e.jumpShowToast(t.message)}))},tidyProductList:function(t){for(var e=this.OrderItem,r=e.AddRound;r>=0;r--){for(var n={addRound:r,list:[]},o=0;o<t.length;o++)t[o].AddRound==r&&n.list.push(t[o]);this.ProductList.push(n)}},getStatusText:function(t){return this.defaultStatus[t]},getDishesStatus:function(t){return 0==t?"未上":1==t?"已上":void 0},tableNumInput:function(t){this.tableNumberText=t.detail.value},setTableNum:function(){var e=this;e.tableNumberText!=e.OrderItem.TableNumber?e.$H.post("/api/Order/SetTableNumber",{OrderID:e.OrderItem.ID,TableNumber:e.tableNumberText},{token:!0}).then((function(t){if(console.log(t),e.jumpShowToast(t.message),0===t.status)for(var r=e.orderList,n=0;n<r.length;n++)r[n].ID==e.OrderItem.ID&&(r[n].TableNumber=e.tableNumberText)})):t.showToast({title:"请设置不同的桌号",icon:"none",duration:1e3})},checkboxChange:function(t){console.log(t.detail.value),this.statusList=t.detail.value},selectAll:function(){if(this.select=!this.select,this.select)for(var t=this.ProductList,e=0;e<t.length;e++)for(var r=0;r<t[e].list.length;r++)0==t[e].list[r].Status&&this.statusList.push(t[e].list[r].ID);else this.statusList=[]},setStatusSubmit:function(){var t=this;t.statusList.length<=0||t.$H.post("/api/Order/SetProductStatus",{OrderID:t.OrderItem.ID,IDs:JSON.stringify(t.statusList)},{token:!0}).then((function(e){console.log(e),t.jumpShowToast(e.message),0==e.status&&t.setStatusSubmitSuccess(t.statusList)}))},setStatusSubmitSuccess:function(t){for(var e=this.ProductList,r=0;r<t.length;r++)for(var n=0;n<e.length;n++)for(var o=0;o<e[n].list.length;o++)t[r]==e[n].list[o].ID&&(e[n].list[o].Status=1)},cancelOrder:function(){var e=this;t.showModal({title:"提示",content:"取消订单",success:function(t){t.confirm?e.$H.post("/api/Order/CancelOrder",{OrderID:e.OrderItem.ID},{token:!0}).then((function(t){if(console.log(t),e.jumpShowToast(t.message),0==t.status){e.OrderItem.Status=5;for(var r=e.orderList,n=0;n<r.length;n++)r[n].ID==e.OrderItem.ID&&(r[n].Status=5)}})):t.cancel&&console.log("用户点击取消")}})},confirmOrder:function(){var e=this;t.showModal({title:"提示",content:"确认订单",success:function(t){t.confirm?e.$H.post("/api/Order/ConfirmOrder",{OrderID:e.OrderItem.ID},{token:!0}).then((function(t){if(console.log(t),e.jumpShowToast(t.message),0==t.status){e.OrderItem.Status=1;for(var r=e.orderList,n=0;n<r.length;n++)r[n].ID==e.OrderItem.ID&&(r[n].Status=1)}})):t.cancel&&console.log("用户点击取消")}})},jumpShowToast:function(e){t.showToast({title:e,icon:"none",duration:1500})}})};e.default=a}).call(this,r("543d")["default"])},e581:function(t,e,r){"use strict";var n,o=function(){var t=this,e=t.$createElement,r=(t._self._c,t.getStatusText(t.OrderItem.Status)),n=t.__map(t.ProductList,(function(e,r){var n=t.__map(e.list,(function(e,r){var n=t.getDishesStatus(e.Status);return{$orig:t.__get_orig(e),m1:n}}));return{$orig:t.__get_orig(e),l0:n}}));t.$mp.data=Object.assign({},{$root:{m0:r,l1:n}})},s=[];r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return s})),r.d(e,"a",(function(){return n}))},fc21:function(t,e,r){"use strict";r.r(e);var n=r("a58a"),o=r.n(n);for(var s in n)"default"!==s&&function(t){r.d(e,t,(function(){return n[t]}))}(s);e["default"]=o.a}},[["5715","common/runtime","common/vendor"]]]);